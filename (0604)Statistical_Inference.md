7일차 (06/04)

### 통계적추론

#### 통계적 추론

모수 (parameter) -> 특성 -> 모집단 (population) "연구대상" -> 표본추출 -> 표본
$$
\mu \ \sigma^2 \ \pi
$$


통계량 (statistic)-> 표본 (sample)
$$
\bar X \ S^2 \ p
$$
통계량 -> 모수 : 분석을 실시 : 추론(Inference)



#### 통계적 추정

- 표본의 정보를 이용하여 실제로 관찰되지 않은 부분을 포함한 모집단 전체에 대한 추측

  모수(모평균,모분산,모비율)<-추정(Estimation)<-통계량(표본평균,표본분산,표본비율)

  - 추정량(Estimator)
  - 추정치(Estimate)

- 점추정(Point Estimation)

  : 하나의 값으로 모수를 추정

  - 모평균을 추정하기 위해서 가장 많이 사용되는 통계량

    = 

- 구간추정(Interval Estimation)

  : 모수가 속하리라고 생각되는 적절한 구간을 설정하여 추정

  - 모평균을 추정하기 위해서 가장 많이 사용되는 통계량

     = 표본평균

  $$
  \bar x = \sum_i^n x_i/n
  $$

  - 모분산을 추정하는데 가장 많이 사용되는 통계량\

    = 표본분산
    $$
    S^2=\sum_i^2 (x_i-\bar x)^2 / (n-1)
    $$
    

  - 두 통계량의 특징 : 불편추정량(unbiased estimate)

  $$
  E(\bar X)=\mu, \ E(S^2)=\sigma^2
  $$

  

- 점추정(Point Estimation)

  - 표본평균으로 모평균을 추정할 때 이 추정치를 얼마나 신뢰할 수 있을까?
  - 특정한 표본에서 표본평균은 하나의 숫자로 계산되지만 다른 표본을 뽑아서 표본평균을 구하면 다른 숫자가 나오게 될 것이다. 실제로, 표본평균은 많은 다른 값을 취할 수 있고, 모집단의 평균 μ와 정확히 같은 표본평균은 거의 찾아볼 수 없을 것이다. 그렇다면 왜 표본평균으로 모평균을 추정하는가?

  - 표본의 크기가 커질수록 표본평균의 분포는 점점 μ 주변으로 집중되고 n이 클 때 표본평균은 모평균에 가까이 있다고 할 수 있을 것이다. 그렇다면 어느 정도 가까울까?

- 구간추정(신뢰구간, Confidence interval)

  - 표본의 크기가 커질수록 표본평균의 분포는 점점 μ 주변으로 집중되고 n이 클 때 표본평균은 모평균에 가까이 있다고 할 수 있을 것이다. 그렇다면 어느 정도 가까울까? -> 구간추정필요

  중심극한정리에 의해, 표본평균의 95% 정도가 모평균으로부터 2표준편차 이상 (더 정확하게 1.96*σ/√n) 떨어져 있지 않다. 즉, 매우 많은 표본을 뽑아서 각각에 대해 표본평균을 계산했을 때, 그 가운데 95% 정도의 표본평균이 모평균에서 2(또는 1.96)표준편차 이상 떨어져 있지 않다는 말이 된다.

  - 모평균의 95% 신뢰구간: 
    $$
    \bar x-1.96\frac{\sigma}{\sqrt n},\ \bar x+1.96\frac{\sigma}{\sqrt n}
    $$

  - 예제) 갈색 계란 하나의 무게가 평균이 65g이고 표준편차가 5g인 정규분포를 따른다고 하고, 12개의 계란이 들어있는 하나의 carton을 크기가 12인 표본이라고 하자.

    - 표본평균의 분포는 평균이 65g이고 표준편차가 1.44g(5/sqrt(12))인 정규분포이다. 이 분포의 중간 95%에 들어가는 계란들은 65±2.82g의 무게를 갖는다.
      $$
      \bar X ± 1.96\frac {5}{\sqrt 12}
      $$

  - 이번에는 흰색 계란 12개가 들어있는 carton을 샀다고 하자. 전체 박스의 무게는 770g 이었다. 그렇다면 이표본의 평균 \bar x 는 770/12=64.2g이 된다.

  - 흰색 계란의 무게의 표준편차도 5g이라고 한다면, 이 표본을 근거로 흰색 계란 무게의 분포의 평균을 어떻게 추정할 수 있을까?

    - 95%의 신뢰도로, 흰색 계란 무게분포의 평균 μ는 표본평균으로부터 대략 ±1.96σ/√n 안에 있다. 즉, 64.2g±2.82g 안에 있다고 할 수 있다.

- 신뢰수준이 C인 신뢰구간 = 표본의 100* C%에서 모평균을 포함하게 되는 신뢰구간
  $$
  \bar x±z*\sigma/\sqrt n
  $$

  - z* 값 찾기:

    - z* 값은 신뢰수준 C와 관계 있다.

    - C는 정규분포 곡선에서 -z* and z* 사이의 면적이다.

    - C=1-a라 하면, z* 는 정규분포에서 상위 a/2 critical value다.

      ((1-a/2)*100백분위수)

    - 보통 정규확률표나 software로 찾는다.

  - 신뢰수준 80%인 신뢰구간을 찾기 위해서는(C=0.8), 정규곡선에서 80%의 면적이 포함되는 구간을 찾아야 한다.



#### 표본크기의 결정

- 어떤 연구에서(신약의 연구, 제조공정 등) 특정한 신뢰도와 신뢰구간의 길이가 필요하다고 가정하자. 많은 경우 모집단의 표준편차는 σ로 고정되어 있으므로, 표본의 크기를 조절하여 원하는 신뢰도와 신뢰구간의 길이를 얻어야 한다.
  $$
  신뢰구간의 \ 길이 = 2×z*\frac {\sigma}{\sqrt n} ⇔ n=(\frac {2×z*\sigma}{신뢰구간의\ 길이})^2
  $$
  

- 물론, 표본크기를 언제나 원하는 만큼 잡을 수 있는 것은 아니고 비용이나 다른 제약조건을 고려해야 하는 경우가 많다. 적절한 결과를 얻을 수 있는 가장 작은 표본크기를 결정하는 것이 좋다.

- 예제)

  - 박테리아의 밀도 계산에서 특정한 측정기계는 s=10^6 bacteria/ml fluid의 표준편차를 보인다.

  - 참밀도에 대한 구간추정이 90%의 신뢰수준을 가지되 신뢰구간의 길이는 10^6 bacteria/ml fluid를 넘지 않기를 원한다면 관측치가 몇 개나 있어야 할까?

  - z*=1.645이어야 하고, m=신뢰구간의 길이/2 라고 했을 때,
    $$
    n=(\frac{z*\sigma}{m})^2\ ⇒ n=(\frac {1.645*1}{0.5})^2=3.29^2=10.8241
    $$

  - 10개의 관측치는 충분하지 않다. 10개를 관측하는 경우 신뢰구간의 길이가 원하는 것보다 길어질 것이므로 11개의 관측치가 필요하다.

- 모분산을 모를 때

  - 표본표준편차 s로 모표준편차 σ를 추정하여 사용한다.

  - 표본의 크기가 크면 표본은 모집단의 형태와 많이 비슷해질 것이고(좋은 표본이라는 가정하에) 이 때는 s가 σ의 좋은 추정치가 될 것이다.

  - 표본의 크기가 작으면 s의 값이 σ와 많이 다를 수도 있다.
    $$
    s=\sqrt \frac{1}{n-1}\sum(x_i-\bar x)^2
    $$



#### t 분포

- 평균이 μ이고 표준편차가 σ인 정규분포에서 크기가 n인 랜덤표본을 뽑을 때, 

  - 표준편차가 알려져 있으면, 표본평균의 분포는 N(m, s2/n).

  - 표준편차가 알려져 있지 않으면, 표본평균의 분포는 자유도가 n-1인 t-분포를 따른다. 즉, 다음의 t 통계량의 분포는 자유도가 n-1인 t분포를 따른다.
    $$
    t=\frac {\bar x-\mu}{s/\sqrt n}\ : 일표본\ t통계량
    $$
    

  - n이 크면, s가 σ 의 좋은 추정치가 되므로, t분포는 정규분포와 매우 비슷한 분포가 된다. 자유도가 줄어들수록 t분포의 분산은 늘어나는데, 이것은 s로 σ를 추정하는 추정의 precision이 떨어짐을 나타낸다고 할 수 있다.
  - 항상 0에 대해 좌우대칭, 자유도가 클수록 정규분포와 유사함.



#### 일표본 t-신뢰구간

- 신뢰수준이 C인 신뢰구간 = 표본의 100*C%에서 모평균을 포함하게 되는 신뢰구간

- 모평균 뿐 아니라 모표준편차도 모르므로, \bar x로 μ를 추정하고 s로 σ를 추정하며, 자유도 n-1인 t분포를 사용한다.

  - 신뢰수준 C(100*C%)인 신뢰구간
    $$
    \bar x±t*s/\sqrt n
    $$

  - t* 값 찾기
    - C는 t(n-1)분포곡선에서 -t*와 t* 사이의 면적이다.
    - C=1-a라 하면, t*는 t(n-1)분포에서 상위 a/2 critical value 이다.
    - 보통 t critical value table이나 software로 찾는다.

- 예제

  - 적포도주를 적당량 마시는 것이 심장마비를 막아줄 수 있다고 알려져 있다. 적포도주에 들어있는 폴리페놀이 그 역할을 하는 것으로 보인다.

  - 적포도주를 적당량 마시는 것이 혈중 폴리페놀의 농도를 올리는 지 확인하기 위해 9명의 랜덤추출된 건강한 남자들에게 2주간 적포도주를 매일 반 병씩 마시도록 하였다. 그들의 혈중 폴리페놀 농도를 연구시작과 끝에 측정하였는데, 그 차이(% change)가 다음과 같이 나타났다.

    0.7	3.5	4	4.9	5.5	7	7.4	8.1	8.4

  - 퍼센트 차이 평균에 대한 95% 신뢰구간을 구하시오.

    표본평균=5.5; s=2.517; df=n-1=8

  - 표본평균의 표본분포는 자유도가 8인 t분포가 된다. 자유도가 8이고 C=0.95이면, t*=2.306, t*값은 t_α/2,n-1 로 쓰기도 한다.

  - 신뢰구간의 길이/2 = t×s/√n = 2.306×2.517/√9 ≒ 1.93

  - 95%의 신뢰도로, 2주간 매일 반 병의 적포도주를 마신 건강한 남성의 혈중 폴리페놀 농도의 퍼센트 증가의 참값은 3.6%에서 7.6% 사이에 있다고 할 수 있다.

    단, 이 신뢰구간은 폴리페놀 농도의 증가만을 얘기할 뿐이고, 실제 이 남성들의 건강에 미치는 영향을 말하고 있지는 않다.